<!--

This program represents the mapping output of a complete miRNA (and other related small RNA) sequencing data set. The
embedded javascript provides the user to dynamically filter through the information relating to individual genes.
The complete data set can be visualised based on a number of parameters. Finally statistics of miR processing can be processed
for further downstream analysis.
Version 1.0
Author: David Thomas Humphreys
Copyright (C) 2012, Victor Chang Cardiac Research Institute

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.
    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    see <http://www.gnu.org/licenses/> for GNU license.

-->
<html><head><style type="text/css">body{white-space:pre;color:blue;font-family:courier;letter-spacing:0px}#test{position:absolute;visibility:hidden;height:auto;width:auto}#DescriptionText{color:black;align:centre}#mainbody{align:center;position:relative;min-height:100%}#sheetText{}#TableText{align:center}#Footer{align:bottom;float:left}#spot{color:orange;font-size:75%}table{font-family:courier;empty-cells:show;border-collapse:collapse}{font-family:courier;empty-cells:show;border-collapse:collapse}td{white-space:nowrap}thead{background-color:black;color:white;text-indent:14px;text-align:left}tbody.mirtable tr:nth-child(odd){background-color:#E3E3E3}tbody.mirtable tr:nth-child(even){background-color:#fafafa}#Y-Axis{-webkit-transform:rotate(-90deg);-moz-transform:rotate(-90deg);-ms-transform:rotate(-90deg);-o-transform:rotate(-90deg);rotate(90deg);transform:rotate(90deg);#width:30px;#vertical-align:bottom;text-align:bottom;padding-right:20px}.axislabels{color:black;font-weight:bold;letter-spacing:1px}.subaxis{color:green;font-size:80%}div.floating-menu{position:fixed;bottom:50px;right:0px;background:#fff4c8;border:1px solid#ffcc00;width:auto;z-index:100;font-size:80%}div.floating-menu a,div.floating-menu h4{display:block;margin:0 0.5em}</style></head><body>
 <div class="floating-menu" id="FloatMenu">
please 
wait 
while
loading
</div>
<div id ="mainbody">
	<div id ="DescriptionText"><a name="Top"></a>Visit the <a href="http://miRspring.victorchang.edu.au">miRspring home page</a> for detailed instructions about this document
DESCRIPTION HERE
	</div>
	<div id="sheetText"></div><br>
	<div id="TableText">
	<br>If this is the only text that loads (may take a few seconds to load), enable javascript in your browser.
	</div><br>
	<div id="test">T</div>
	<div id="footer"><a name="Bottom"></a></div>
</div><br>
<script language="JavaScript">
/* GLOBAL VARIABLES */
var Largest_Count = 1;var Smallest_Count = 1;var Interactive_Graph = 1;var HeaderInfo = new Object();
MIRDSPRING DATA HERE
// This code has been condensed to save space. If you wish to view a readible version please visit the miRspring web site.
var Spacer=SpacerMax;var char_width=document.getElementById("test").offsetWidth+'px';var ShowALL_miRs=0;var EDITMODE=0;var GlobalEditFiveP=0;var GlobalEditThreeP=0;var SortCol=8;function sortMultiDimensional(a,b){return((a[SortCol]>b[SortCol])?-1:((a[SortCol]<b[SortCol])?1:0))}function sortMultiDimensionalDown(a,b){return((a[SortCol]<b[SortCol])?-1:((a[SortCol]>b[SortCol])?1:0))}function customSort(a,b){return[a[1],a[2]]>[b[1],b[2]]?1:-1}function EditSort(a,b){return[a[1],a[2],a[4]]>[b[1],b[2],b[4]]?1:-1}function StableSort(a,b){if(a[SortCol]===b[SortCol]){return((a[3]<b[3])?-1:1)}return((a[SortCol]>b[SortCol])?-1:((a[SortCol]<b[SortCol])?1:0))}function StableSortDown(a,b){if(a[SortCol]===b[SortCol]){return((a[3]>b[3])?-1:1)}return((a[SortCol]<b[SortCol])?-1:((a[SortCol]>b[SortCol])?1:0))}function sortFiveP_ThreeP_Down(a,b){return(((a[9]+a[10])<(b[9]+b[10]))?-1:(((a[9]+a[10])>(b[9]+b[10]))?1:0))}function sortFiveP_ThreeP(a,b){return(((a[9]+a[10])>(b[9]+b[10]))?-1:(((a[9]+a[10])<(b[9]+b[10]))?1:0))}function TotalTags(){var a=new Object();a.mir=0;a.everything=0;a.other=0;for(var i=0;i<miRBaseDataSet.length-1;i++){var b=miRBaseDataSet[i][1].match(/\w\w\w/g);b[1]=(b[1]=='let')?'mir':b[1];if(b[1]=='mir'){a.mir+=miRBaseDataSet[i][8]}else{a.other+=miRBaseDataSet[i][8]}a.everything+=miRBaseDataSet[i][8]}return a}function EditStatus(){var a='<fieldset><legend>Edit mirbase coordinates</legend><form name="EditForm">User can redefine mirBase entry : ON <input type="radio" ';var b=' value="ON" name ="EDITON" onclick="EDITMODE=1;document.EditForm.EDITOFF.checked = false;"> OFF<input type="radio" ';var c=' value="OFF" name ="EDITOFF" onclick="EDITMODE=0;document.EditForm.EDITON.checked = false;"></form></fieldset>';var d=(EDITMODE==1)?a+'checked'+b+c:a+b+'checked'+c;return d}function Flanking_option(){var a='<fieldset><legend>Display precursor flanking sequence</legend><form name="Flanking_window">When Selected <input type="radio" ';var b=' value="ON" name ="FLANKON" onclick="document.Flanking_window.FLANKOFF.checked = false;debugme();"> Always <input type="radio" ';var c=' value="OFF" name ="FLANKOFF" onclick="document.Flanking_window.FLANKON.checked = false;debugme();"></form></fieldset>';var d=(FlankingSeq==0)?a+'checked'+b+c:a+b+'checked'+c;return d}function Seed_option(){var a='<fieldset><legend>RNA classes to include in seed analysis</legend><form name="SeedClass_window">Everything <input type="radio" ';var b=' value="ON" name ="ALLSEEDS" onclick="document.SeedClass_window.MIRSEEDS.checked = false;debugme('+"'seed'"+');"> Only miRs <input type="radio" ';var c=' value="OFF" name ="MIRSEEDS" onclick="document.SeedClass_window.ALLSEEDS.checked = false;debugme('+"'seed'"+');"></form></fieldset>';var d=(SeedClass==1)?a+'checked'+b+c:a+b+'checked'+c;return d}function Normalise_option_OLD(){var a='<fieldset><legend>Normalisation</legend><form name="RPM">None (Raw counts) <input type="radio" ';var b=' value="ON" name ="RAWCOUNTS" onclick="document.RPM.RPM_MIR.checked = false;debugme();">Reads per million (miRs) <input type="radio" ';var c=' value="OFF" name ="RPM_MIR" onclick="document.RPM.RAWCOUNTS.checked = false;debugme();"></form></fieldset>';var d=(RPM==0)?a+'checked'+b+c:a+b+'checked'+c;return d}function Normalise_option(){var a='<tr><td>';a+='<form name="RPM">Test : ON <input type="radio" ';var b=' value="ON" name ="RAWCOUNTS" onclick="document.RPM.RPM_MIR.checked = false;debugme();"> OFF<input type="radio" ';var c=' value="OFF" name ="RPM_MIR" onclick="document.RPM.RAWCOUNTS.checked = false;debugme();"></form>';c+='</td></tr>';var d=(RPM==0)?a+'checked'+b+c:a+b+'checked'+c;return d}function TransparentBox(a,b,c){var d='<img title="'+c+'" width="'+a+'" height="'+b+'" src="data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7">';return d}function ReturnToMain(a){var b=(a!=undefined)?"BACK to main table"+a:"Back to main table";return('<input type="button" value="'+b+'" onclick="XY_Scatter(); displayTable();">')}function addCommas(a){a+='';x=a.split('.');x1=x[0];x2=x.length>1?'.'+x[1]:'';var b=/(\d+)(\d{3})/;while(b.test(x1)){x1=x1.replace(b,'$1'+','+'$2')}return x1+x2}function TwoDesPlaces(a){a=a*100;a=Math.round(a);return(addCommas(a/100))}function moveWindow(a){window.location.hash=a}function findmiR_inTable(){var a=SortCol;var b='<select name="miRlist">';var c=new Array(1);for(var i=0;i<miRBaseDataSet.length;i++){if(miRBaseDataSet[i]==undefined)continue;c[i]=miRBaseDataSet[i][1]}c.sort();for(var i=0;i<c.length;i++){if(miRBaseDataSet[i]==undefined)continue;b+='<option '+i+' onclick="moveWindow('+"'"+c[i]+"'"+')">'+c[i]+'</option>'}b+='</select>';return b}function displayTable(a){var b=miRBaseDataSet.length-1;var i=0;var c='';var d='<table class="mirtable"; align="center"; border ><caption>'+c+'</caption><thead>';var e='input type="button" value=';d+='<tr><th>Rank<br>&nbsp</th><th>ID<br>&nbsp</th><th>Class<br>&nbsp</th><th>More details<br>&nbsp</th><th>TOTAL<br><input type="button" value="Des"onclick="SortCol=8;displayTable();"><input type="button" value="Asc"onclick="SortCol=8;displayTable(\'Asc\');"></th>';d+='<th>5p + 3p<br><input type="button" value="Des" onclick="miRBaseDataSet.sort(sortFiveP_ThreeP);displayTable(\'None\');"> <input type="button" value="Asc" onclick="miRBaseDataSet.sort(sortFiveP_ThreeP_Down);displayTable(\'None\');"></th>';d+='</th><th>5p<br><input type="button" value="Des"onclick="SortCol=9;displayTable();"><input type="button" value="Asc"onclick="SortCol=9;displayTable(\'Asc\');"></th>';d+='<th>3p<br><input type="button" value="Des"onclick="SortCol=10;displayTable();"><input type="button" value="Asc"onclick="SortCol=10;displayTable(\'Asc\');"></th>';d+='<th>Other<br><input type="button" value="Des"onclick="SortCol=11;displayTable();"><input type="button" value="Asc" onclick="SortCol=11;displayTable(\'Asc\');"></th></tr></thead><tbody class="mirtable">';if(a=='Asc'){miRBaseDataSet.sort(sortMultiDimensionalDown)}else if(a=='None'){}else{miRBaseDataSet.sort(sortMultiDimensional)}var f=TotalTags();for(i=0;i<b;i++){var g=i+1;var h=miRBaseDataSet[i][1].match(/\w\w\w/g);h[1]=(h[1]=='let')?'mir':h[1];d+='<tr><td><a name="'+miRBaseDataSet[i][1]+'"></a>'+g+'</td><td>'+miRBaseDataSet[i][1]+'</td><td>'+h[1]+'</td><td><input type="button" value="View reads/details" onclick="displayMirnaInfo('+miRBaseDataSet[i][0];if(RPM==0){f.hairpin=addCommas(miRBaseDataSet[i][8]);f.fiveP=(miRBaseDataSet[i][5]==undefined)?'undefined':addCommas(miRBaseDataSet[i][9]);f.threeP=(miRBaseDataSet[i][7]==undefined)?'undefined':addCommas(miRBaseDataSet[i][10]);f.fiveP_threeP=addCommas(miRBaseDataSet[i][9]+miRBaseDataSet[i][10]);f.other=addCommas(miRBaseDataSet[i][11])}else{var j=1000000;var k=(RPM==1)?f.mir:f.other;f.hairpin=TwoDesPlaces(miRBaseDataSet[i][8]/k*j);f.fiveP=(miRBaseDataSet[i][5]==undefined)?'undefined':TwoDesPlaces(miRBaseDataSet[i][9]/k*j);f.threeP=(miRBaseDataSet[i][7]==undefined)?'undefined':TwoDesPlaces(miRBaseDataSet[i][10]/k*j);f.fiveP_threeP=TwoDesPlaces((miRBaseDataSet[i][9]+miRBaseDataSet[i][10])/k*j);f.other=TwoDesPlaces(miRBaseDataSet[i][11]/k*j)}d+=',\'\');"></td><td align=right>'+f.hairpin+'</td><td align=right>';d+=f.fiveP_threeP+'</td><td align=right>';d+=f.fiveP+'</td><td align=right>';d+=f.threeP+'</td><td align=right>';d+=f.other+'</td></tr>'}d+='</tbody></table><br><input type="button" value="list ALL sequences" onclick="DownloadSeq();">';d+='</table><br><input type="button" value="SHOW ALL sequences" onclick="ShowALLSeq();">';var l='<h4>Navigation</h4><input type="button" value="Top"onclick="moveWindow('+"'Top'"+');">';l+='<input type="button" value="Bottom"onclick="moveWindow('+"'Bottom'"+');"><br><input type="button" value="Mirspring OPTIONS"onclick="OptionsMenu();"><br>Find miR:<br>'+findmiR_inTable();document.getElementById("FloatMenu").innerHTML=l;document.getElementById("TableText").innerHTML=d}function Extract_miR_Data(a){var b=-1,Length=-1;for(var i=0,k=0;i<data.length;i++){if((b==-1)&&(data[i][0]==a)){b=i}else if((b!=-1)&&(data[i][0]!=a)){Length=i-b;break}}SortCol=0;miRBaseDataSet.sort(sortMultiDimensionalDown);var c=[];var d=0;for(var i=0;i<Length;i++){if((data[i+b][4]!='')&&(RNAEditing==1)){continue}else if((data[i+b][4]=='')&&(RNAEditing==2)){continue}else if(RNAEditing==3){var e=data[i+b][4].match(/AG/);var f=data[i+b][4].match(/CT/);if((AtoI==null)&&(f==null)){continue}}c[d]=new Array(5);for(var j=0;j<5;j++){c[d][j]=data[i+b][j]}d++}return(c)}function displayMirnaInfo(a,b){var c=SortCol;var d=Extract_miR_Data(a);d.sort(customSort);if(RNAEditing!=1){SortCol=4;d.sort(sortMultiDimensionalDown)}var e;for(var i=0;i<miRBaseDataSet.length-1;i++){if(miRBaseDataSet[i][0]==a){e=i}}var f=miRBaseDataSet[e][2].substr(Spacer,miRBaseDataSet[e][2].length-Spacer-Spacer);f=f.length;var g=0;for(var i=d[0][0];i<Genome.length-1;i++){if(miRBaseDataSet[d[0][0]][0]==Genome[i][0]){g=i;break}}var h=Genome[g][2]+f-1;var j=miRBaseDataSet[d[0][0]][1]+' ('+Genome[g][1]+':'+Genome[g][2]+'-'+h+')<br><br>';var k=NeighbourAnalysis(g);var l="<br>"+miRBaseDataSet[e][2].substr(Spacer,f);if((miRBaseDataSet[e][4]!=undefined)||(miRBaseDataSet[e][6]!=undefined)){if(miRBaseDataSet[e][4]==undefined){l="<br>"+miRBaseDataSet[e][2].substr(Spacer,miRBaseDataSet[e][6]-Spacer)}else{l="<br>"+miRBaseDataSet[e][2].substr(Spacer,miRBaseDataSet[e][4]-Spacer);l+='<font color ="green">'+miRBaseDataSet[e][2].substr(miRBaseDataSet[e][4],miRBaseDataSet[e][5]-miRBaseDataSet[e][4])+'</font>';l+=miRBaseDataSet[e][2].substr(miRBaseDataSet[e][5],miRBaseDataSet[e][6]-miRBaseDataSet[e][5])}if(miRBaseDataSet[e][6]==undefined){l+=miRBaseDataSet[e][2].substr(miRBaseDataSet[e][5],(miRBaseDataSet[e][2].length-Spacer)-miRBaseDataSet[e][5])}else{l+='<font color ="green">'+miRBaseDataSet[e][2].substr(miRBaseDataSet[e][6],miRBaseDataSet[e][7]-miRBaseDataSet[e][6])+'</font>';l+=miRBaseDataSet[e][2].substr(miRBaseDataSet[e][7],(miRBaseDataSet[e][2].length-Spacer)-miRBaseDataSet[e][7])}}var m=Display_Collapsed_FiveP_Sequence(b,j,e,f,l,d);var n='Change Polycistronic window size :';var o=[a];for(var i=0;i<WindowSize.length;i++){n+=(WindowOption==i)?WindowSize[i]:'<input type="button" value="'+WindowSize[i]+'"onclick="ChangeCistronWindow('+i+',\'\','+o+');">'}var p='<table cellSpacing=0 cellPadding=0 border=2 Align=left><caption>'+ReturnToMain()+'</caption>';p+='<tr><td>'+n+'</td></tr><td>'+k+'</td><td></td></tr><tr><td>'+m+'</td></tr></table></td></tr></table><br>';SortCol=c;miRBaseDataSet.sort(sortMultiDimensional);if(ShowALL_miRs==1){return(m+'</td></tr></table><br>')}var q='<h4>Navigation</h4><input type="button" value="Top"onclick="moveWindow('+"'Top'"+');">';q+='<input type="button" value="Bottom"onclick="moveWindow('+"'Bottom'"+');"><br>'+ReturnToMain();document.getElementById("FloatMenu").innerHTML=q;document.getElementById("sheetText").innerHTML=p;document.getElementById("TableText").innerHTML='';moveWindow('Top')}function ChangeCistronWindow(a,b,c){WindowOption=a;if(b=='polyciston'){}else{displayMirnaInfo(c)}}function Display_Collapsed_FiveP_Sequence(a,b,c,d,e,f){var g=['',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var h=[];var k=0;var l=2;var m=0;var n=Spacer-1;var o=f[0][4];var p=new Array(miRBaseDataSet[c][2].length);for(var i=0;i<miRBaseDataSet[c][2].length;i++){p[i]=0}var q=0;var r=[0,0,0,0,0,0];var s='';var t=0;var u=[0,0,0,0];for(var i=0;i<f.length;i++){r[3]+=f[i][3];if((f[i][1]<Spacer)||(f[i][1]>(d+Spacer))){continue}var v=f[i][1]+f[i][2];for(var j=f[i][1];j<v;j++){p[j]+=f[i][3];q=(p[j]>q)?p[j]:q}t+=f[i][3];var w=Math.abs(f[i][1]-miRBaseDataSet[c][4]);var x=Math.abs(f[i][1]-miRBaseDataSet[c][6]);var y=((w<=miRBaseWindow)||(x<=miRBaseWindow))?'.':'-';var z=2;if((miRBaseDataSet[c][4]!=undefined)&&(w<=3)){z=0;u[1]+=(f[i][1]+f[i][2]-miRBaseDataSet[c][5]==0)?f[i][3]:0;u[0]+=(w==0)?f[i][3]:0}else if((miRBaseDataSet[c][6]!=undefined)&&(x<=3)){z=1;u[3]+=(f[i][1]+f[i][2]-miRBaseDataSet[c][7]==0)?f[i][3]:0;u[2]+=(x==0)?f[i][3]:0}r[z]+=f[i][3];if(a=='Show all tags'){h[k]=new Array(2);h[k][0]='';for(var j=0;j<(f[i][1]-Spacer);j++){h[k][0]+=y}if(f[i][4]!=''){var A=f[i][4].match(/\D+/g);var B=f[i][4].match(/\d+/g);var C=A[0].charAt(1);s=miRBaseDataSet[c][2].substr(0,(f[i][1]+Number(B[0])-1))+C.toLowerCase()+miRBaseDataSet[c][2].substr(f[i][1]+Number(B[0]))}else{s=miRBaseDataSet[c][2]}h[k][0]+=s.substr(f[i][1],f[i][2]);for(var j=h[k][0].length;j<d;j++){h[k][0]+=y}h[k++][1]=f[i][3];continue}if((f[i][1]==n)&&(f[i][4]==o)){var D=f[i][2]-f[i-1][2];for(var j=1;j<D;j++){g[l++]=0}g[0]+='<FONT color = "'+Colour[l-2]+'">'+s.substr(f[i][1]+f[i][2]-D,D)+'</FONT>';g[1]+=f[i][3];g[l++]+=f[i][3]}else{if(f[i][4]!=''){var A=f[i][4].match(/\D+/g);var B=f[i][4].match(/\d+/g);var C=A[0].charAt(1);s=miRBaseDataSet[c][2].substr(0,(f[i][1]+Number(B[0])-1))+C.toLowerCase()+miRBaseDataSet[c][2].substr(f[i][1]+Number(B[0]))}else{s=miRBaseDataSet[c][2]}if(((k!=0)||(l!=2))&&(m==0)){var E=g[0].match(/\w+/);E=E[0].length+l-4;var F=g[0].substr(0,1);F=((F=='.')||(F=='-'))?F:'-';if(f[i][4]==''){for(var j=E+f[i][1]-Spacer;j<d;j++){g[0]+=F}}h[k]=g.slice(0);k++}g=['',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];l=2;for(var j=0;j<(f[i][1]-Spacer);j++){g[0]+=y}g[0]+=s.substr(f[i][1],f[i][2]);m=0;var G=(f[i+1]==undefined)?-1:f[i+1][1];var H=(f[i+1]==undefined)?-1:f[i+1][4];g[1]+=f[i][3];g[l++]=f[i][3];if((f[i][1]!=G)||(f[i][4]!=H)){var F=d-f[i][1]+Spacer-f[i][2];if(f[i][4]==''){for(var j=0;j<F;j++){g[0]+=y}}l=2;h[k]=g.slice(0);k++;m++}n=f[i][1];o=f[i][4]}}var I=1/d*100;var J=(a=='Show all tags')?'Show 5p condensed tags':'Show all tags';var K='<TABLE height=103 cellSpacing=0 cellPadding=0 border=1><caption>'+b+'<input type="button" value="'+J+'"onclick="displayMirnaInfo('+miRBaseDataSet[c][0]+',\''+J+'\');"></caption><tr valign="bottom"><td>';var L=TransparentBox(char_width,'1px');for(var i=0;i<(p.length-Spacer);i++){if(i<Spacer){continue}p[i]=p[i]/q*100;if(p[i]<1){p[i]=1}var M=(((i>=miRBaseDataSet[c][4])&&(i<miRBaseDataSet[c][5]))||((i>=miRBaseDataSet[c][6])&&(i<miRBaseDataSet[c][7])))?'green':'red';var N=((Math.abs(i-miRBaseDataSet[c][4])<=miRBaseWindow)||(Math.abs(i-miRBaseDataSet[c][6])<=miRBaseWindow))?'black':'';K+='<TABLE height=100% cellSpacing=0 cellPadding=0 border=0 Align=left>';K+='<TR><TD></TD></TR><TR><TD style = "background-color:'+M+'" height='+p[i]+'%>'+L+'</TD></TR>';K+='<tr><td style = "background-color:'+N+'"; height=3>'+L+'</td></tr></TABLE>'}K+='</td></tr></table>';var O=SortCol;SortCol=1;h.sort(sortMultiDimensional);SortCol=O;var P=r[3]-r[2]-r[1]-r[0];miRBaseDataSet[c][8]=r[3];miRBaseDataSet[c][9]=r[0];miRBaseDataSet[c][10]=r[1];miRBaseDataSet[c][11]=r[3]-r[1]-r[0];miRBaseDataSet[c][13]=r[0]-u[0];miRBaseDataSet[c][14]=r[0]-u[1];miRBaseDataSet[c][15]=r[1]-u[2];miRBaseDataSet[c][16]=r[1]-u[3];for(var i=0;i<=3;i++){var Q=(i>1)?1:0;u[i]=Math.round(miRBaseDataSet[c][i+13]/r[Q]*1000)/10;u[i]=addCommas(miRBaseDataSet[c][i+13])+' ('+u[i]+'%)'}var R='Total counts :'+addCommas(r[3])+'<br><br>5p counts: '+addCommas(r[0])+'<br> 3p counts: '+addCommas(r[1])+'<br> Other counts: '+addCommas(r[2])+'<br>Flank counts: ';if(P==0){if(Spacer==0){var S=",\'"+a+"\'";R+='<input type="button" value="0" onclick="Spacer=SpacerMax; displayMirnaInfo('+miRBaseDataSet[c][0]+S+');"><br>'}else{R+='0'}}else{if(Spacer==0){R+=addCommas(P)}else{var S=",\'"+a+"\'";R+='<input type="button" value="'+addCommas(P)+'" onclick="Spacer=0;displayMirnaInfo('+miRBaseDataSet[c][0]+S+');">'}}R+='<br>5p 5\' isomirs:'+u[0]+'<br>5p 3\' isomirs:'+u[1];R+='<br>3p 5\' isomirs:'+u[2]+'<br>3p 3\' isomiRs:'+u[3];var T='<TABLE height=16 cellSpacing=0 cellPadding=1 border=1 rules=cols>';T+='<tr><td VAlign=bottom>'+K+'</td><td colspan=3>'+R+'</td></tr>';T+='<tr><td>'+e+'&nbsp</td><td>Counts&nbsp</td>';T+=(a=='Show all tags')?'<td>Length</td></tr>':'<td>3\' isomiR freq&nbsp</td><td>Dominant<br>length</td></tr>';for(var i=0;i<h.length;i++){var U='';var V=2;var W='';if(a!='Show all tags'){for(var j=2;j<h[i].length-1;j++){h[i][j]=h[i][j]/h[i][1]*100;h[i][j]=((h[i][j]<1)||(isNaN(h[i][j])))?1:h[i][j];U+='<TABLE height=100% width=10 cellSpacing=0 cellPadding=0 border=0 Align=left>';U+=(h[i][j]>1)?'<tr><td>'+L+'</td></tr><tr><td style = "background-color:'+Colour[j-2]+'" height='+h[i][j]+'%></TD>'+L+'</TR></TABLE>':'<tr><td>'+L+'</td></tr><tr><td></td></tr></table>';V=(h[i][V]<h[i][j])?j:V}}if(h[i][0]!=''){W=h[i][0].match(/\w+/);W=W[0].length+V-2;var X=h[i][0].match(/\W+/);if(EDITMODE){h[i][1]='<input type="button" value="'+h[i][1]+'" onclick="EditCoords('+miRBaseDataSet[c][0]+','+X[0].length+','+W+','+d+');">'}W='<FONT color = "'+Colour[V-2]+'">'+W;T+='<tr><td>'+h[i][0]+'</td><td align=right>'+addCommas(h[i][1]);T+=(a=='Show all tags')?'</td><td>'+W+'</td></tr>':'</td><td VAlign=bottom>'+U+'</td><td>'+W+'nt</td></tr>'}}GlobalEditFiveP=0;GlobalEditThreeP=0;return(T)}function EditCoords(a,b,c,d){var e=(b<d/2)?4:6;b+=Spacer;miRBaseDataSet[a][e]=b;miRBaseDataSet[a][e+1]=b+c;displayMirnaInfo(miRBaseDataSet[a][0],'')}function NeighbourAnalysis(a,b){var c=WindowSize[WindowOption];var d=a-1;var e=a+1;var f=miRBaseDataSet[Genome[a][0]][8];var g=150;var h;var j=0;var k=[];if(a>0){h=((Genome[a][1]==Genome[d][1])&&((Genome[a][2]-Genome[d][2])<c))?1:0;for(var i=0;h;i++){if(d!=0){h=((Genome[a][1]==Genome[d-1][1])&&((Genome[a][2]-Genome[d-1][2])<c))?1:0}else{h=0;continue}k[i]=new Array(5);if(isNaN(Number(Genome[d][0]))){k[i]=[0,Genome[d--][0],''];continue}k[i][0]=miRBaseDataSet[Genome[d][0]][8];f=(k[i][0]>f)?k[i][0]:f;k[i][1]=miRBaseDataSet[Genome[d][0]][1];k[i][2]=miRBaseDataSet[Genome[d][0]][0];k[i][3]=Genome[d][3];k[i][4]=Genome[d--][2]}}var l=[];if(a<Genome.length-2){h=((Genome[a][1]==Genome[e][1])&&((Genome[e][2]-Genome[a][2])<c))?1:0;for(var i=0;(h);i++){if(e<Genome.length-2){h=((Genome[a][1]==Genome[e+1][1])&&((Genome[e+1][2]-Genome[a][2])<c))?1:0}else{h=0;continue}l[i]=new Array(5);if(isNaN(Number(Genome[e][0]))){l[i]=[0,Genome[e++][0],''];continue}l[i][0]=miRBaseDataSet[Genome[e][0]][8];f=(l[i][0]>f)?l[i][0]:f;l[i][1]=miRBaseDataSet[Genome[e][0]][1];l[i][2]=miRBaseDataSet[Genome[e][0]][0];l[i][3]=Genome[e][3];l[i][4]=Genome[e++][2]}}var m=Genome[e-1][2]+80;j='('+Genome[d+1][1]+':'+Genome[d+1][2]+'-'+m+')';var n=(b!='Data')?'<TABLE height='+g+' cellSpacing=0 cellPadding=0 border=0><caption>'+j+' </caption><tr><td>':'<TABLE border=1><tr><td>'+j+'</td><td>';var o='<TABLE height='+g+'cellSpacing=0 cellPadding=0 border=1 rules=cols Align=left>';var p=0;var q='';var r=0;for(var i=k.length-1;i>=0;i--){if(b=='Data'){q+='</TD><TD>'+k[i][0];n+=' '+k[i][1]}else{if(r==2){r=0}else if((r==0)&&(i<k.length-1)){n+='<tr><td height =5%> <font SIZE=0.5em>&nbsp</font></td></tr></TABLE>'}k[i][0]=Math.round(k[i][0]/f*108);k[i][0]=((k[i][0]<1)&&(k[i][0]>0))?1:k[i][0];var s=(k[i][3]=='+')?'----->':' <------';n+=o+'<TR><TD>';n+=(k[i][0]==0)?'':'</TD></TR><TR><TD style = "background-color:brown" height='+k[i][0]+' onclick="displayMirnaInfo('+k[i][2]+')" >';n+='</TD></TR><tr><td height = 1em>'+k[i][1]+'</td></tr><tr><td height=1em>'+s+'</td></tr>';if(r==1){n+='<tr><td height =5%> <font SIZE=0.5em>_________|</font></td></tr></TABLE>';r=2}if((i>0)&&(r!=2)){r=((k[i-1][4]-k[i][4]<50)&&(k[i-1][3]!=k[i][3]))?1:0}if(r==1){n+='<tr><td height =5% align = right> <font SIZE=0.5em> |_________</font></td></tr></TABLE>'}}p++}if(b=='Data'){q+='</TD><TD>'+miRBaseDataSet[Genome[a][0]][8];n+=' '+miRBaseDataSet[Genome[a][0]][1]}else{var t=(GraphOption==6)?'onclick=\"displayMirnaInfo('+miRBaseDataSet[Genome[a][0]][0]+')\"':'';var s=(Genome[a][3]=='+')?'----->':' <------';var u=Math.round(miRBaseDataSet[Genome[a][0]][8]/f*108);var v='&nbsp';if((r!=2)&&(k[0]!=undefined)){r=((Genome[a][2]-k[0][4]<50)&&(Genome[a][3]!=k[0][3]))?1:0;v=(r==1)?' |__________':'&nbsp';n+=(k.length>0)?' <tr><td height =5% align=right><font SIZE=0.5em>'+v+'</font></td></tr></TABLE>':''}n+=o+'<TR><TD></TD></TR><TR><TD style = "background-color:green" height='+u+''+t+'></TD></TR><tr><td height = 1em>&nbsp'+miRBaseDataSet[Genome[a][0]][1]+'&nbsp</td></tr><tr><td height=1em>&nbsp'+s+' </td></tr>';n+=(r==1)?'<tr><td height =5%> <font SIZE=0.5em> _________|</font></td></tr></TABLE>':(l.length<1)?'<tr><td height =5% align=right><font SIZE=0.5em>&nbsp</font></td></tr></TABLE>':''}for(var i=0;i<l.length;i++){if(b=='Data'){q+='</TD><TD>'+l[i][0];n+=' '+l[i][1]}else{var w='&nbsp';if(i==0){if(r==1){r=0}else{if((l[0][4]-Genome[a][2]<50)&&(l[0][3]!=Genome[a][3])){w='|__________';r=1}n+='<tr><td height=5% align=right><font SIZE=0.5em>'+w+'</font></td></tr></TABLE>'}}else if(r==1){n+='<tr><td height =5%> <font SIZE=0.5em> _______|</font></td></tr></TABLE>';r=0}else{r=((l[i][4]-l[i-1][4]<50)&&(l[i][3]!=l[i-1][3]))?1:0;w=(r==1)?'|_________':'&nbsp';n+='<tr><td height =5% align = right> <font SIZE=0.5em>'+w+'</font></td></tr></TABLE>'}l[i][0]=Math.round(l[i][0]/f*108);l[i][0]=((l[i][0]<1)&&(l[i][0]>0))?1:l[i][0];var s=(l[i][3]=='+')?'----->':' <------';n+=o+'<TR><TD>';n+=(l[i][0]==0)?'':'</TD></TR><TR><TD style = "background-color:brown" height='+l[i][0]+' onclick="displayMirnaInfo('+l[i][2]+')">';n+='</TD></TR><td height = 1em>'+l[i][1]+'</td></tr><tr><td height=1em>'+s+'</td></tr>';w=(r==1)?' __________|':'&nbsp';n+=(i==l.length-1)?'<tr><td height =5%> <font SIZE=0.5em>'+w+'</font></td></tr></TABLE>':''}p++}n+=(b=='Data')?q+'</td></tr></table>':'</td></tr></table>';n=(p==0)?'Mono-cistronic':n;return(n)}function XY_Scatter(){var a=100;var b=SortCol;SortCol=8;miRBaseDataSet.sort(sortMultiDimensional);SortCol=b;var c=new Array(miRBaseDataSet.length-1);var d=0;var e=0;var f='<p class="axislabels">Abundance (log scale)</p>';var g=0;if(GraphOption==7){for(var i=0;i<miRBaseDataSet.length-1;i++){d+=miRBaseDataSet[i][8]}f='<p class="axislabels">Rank</p>'}for(var i=0;i<miRBaseDataSet.length-1;i++){c[i]=[0,0,0];if(GraphOption==7){c[i][0]=Math.round(i/miRBaseDataSet.length*a)}else{c[i][0]=Math.round(Math.log(miRBaseDataSet[i][8])/Math.log(Largest_Count)*a-1);c[i][0]=(c[i][0]<0)?0:c[i][0]}if(GraphOption==0){c[i][1]=Math.round(miRBaseDataSet[i][12]/30*a)}else if(GraphOption==2){c[i][1]=Math.round((miRBaseDataSet[i][13]+miRBaseDataSet[i][15])/(miRBaseDataSet[i][9]+miRBaseDataSet[i][10])*a)}else if(GraphOption==3){c[i][1]=Math.round((miRBaseDataSet[i][14]+miRBaseDataSet[i][16])/(miRBaseDataSet[i][9]+miRBaseDataSet[i][10])*a)}else if(GraphOption==5){c[i][1]=Math.round((miRBaseDataSet[i][8]-miRBaseDataSet[i][9]-miRBaseDataSet[i][10])/miRBaseDataSet[i][8]*a)}else if(GraphOption==10){c[i][1]=Math.round(miRBaseDataSet[i][17]/miRBaseDataSet[i][8]*a)}else if(GraphOption==7){e+=miRBaseDataSet[i][8];c[i][1]=Math.round(e/d*a);if(i>0){g+=((c[i][0]!=c[(i-1)][0])&&(c[i][1]==c[(i-1)][1]))?0:1}}else if(GraphOption==8){c[i][1]=Math.round(i/miRBaseDataSet.length*a)}else{c[i][1]=Math.round(miRBaseDataSet[i][9]/(miRBaseDataSet[i][9]+miRBaseDataSet[i][10])*a)}if(c[i][1]>a){var h=9}c[i][1]=((GraphOption!=8)&&(c[i][1]>a))?a:c[i][1];if(isNaN(c[i][1])){c[i][1]=0;c[i][0]=0}c[i][2]=miRBaseDataSet[i][0]}drawXYgraph(c,a,f,g)}function GraphSeed(a){var b=SortCol;SortCol=0;miRBaseDataSet.sort(sortMultiDimensionalDown);SortCol=b;var c=new Object();var d=Largest_Count;var e=new Object();var f='\\n--------------';for(var i=0;i<miRBaseDataSet.length-1;i++){if(miRBaseDataSet[data[i][0]]==undefined){continue}if(miRBaseDataSet[i][4]!=''){var g=miRBaseDataSet[i][2].substr((miRBaseDataSet[i][4]+1),7);e[g]=(e[g]==undefined)?miRBaseDataSet[i][9]:e[g]+miRBaseDataSet[i][9];if(c[g]==undefined){c[g]='SEED = '+g+f+'\\nMIRBASE'}c[g]+='\\n'+miRBaseDataSet[i][1]+' (5p). Counts = '+miRBaseDataSet[i][9];d=(d<e[g])?e[g]:d}if(miRBaseDataSet[i][6]!=''){var g=miRBaseDataSet[i][2].substr((miRBaseDataSet[i][6]+1),7);e[g]=(e[g]==undefined)?miRBaseDataSet[i][10]:e[g]+miRBaseDataSet[i][10];if(c[g]==undefined){c[g]='SEED = '+g+f+'\\nMIRBASE:'}c[g]+='\\n'+miRBaseDataSet[i][1]+' (3p). Counts = '+miRBaseDataSet[i][10];d=(d<e[g])?e[g]:d}}var h=new Object();var k=new Object();for(var i=0;i<data.length-1;i++){if(miRBaseDataSet[data[i][0]]==undefined){continue}var g=miRBaseDataSet[data[i][0]][2].substr((data[i][1]+1),7);h[g]=(h[g]==undefined)?data[i][3]:h[g]+data[i][3];var l=new RegExp(miRBaseDataSet[data[i][0]][1]+", Counts = \\d+");var m=null;if(c[g]==undefined){c[g]='SEED = '+g+f+'\\nNo mirBase seed'+f+'\\nDATA'}else if(m=l.exec(c[g])){var n=/= (\d+)/;var o=n.exec(m);o=Number(o[1])+data[i][3];c[g]=c[g].replace(m,miRBaseDataSet[data[i][0]][1]+', Counts = '+o)}else{var p=new RegExp("DATA");var q=(p.test(c[g]))?'':f+'\\nDATA\\n';c[g]+='\\n'+q+miRBaseDataSet[data[i][0]][1]+', Counts = '+data[i][3]}d=(d<h[g])?h[g]:d}var r=[];var j=0;for(var i in e){r[j]=[e[i],0,c[i]];if(h[i]!=undefined){r[j][1]=h[i];h[i]=''}else{r[j][1]=0}j++}var s=new Object();for(var i in h){if((h[i]>Smallest_Count)&&(s[h[i]]==undefined)){r[j++]=[0,h[i],c[i]];s[h[i]]=1}}if(a=='Table'){return(r)}var t=100;for(var i=0;i<r.length;i++){r[i][0]=(r[i][0]==0)?0:Math.round(Math.log(r[i][0])/Math.log(d)*t);r[i][1]=(r[i][1]==0)?0:Math.round(Math.log(r[i][1])/Math.log(d)*t)}drawXYgraph(r,100,'Seed Frequency (mirBase)',0)}function CreateSeedTable(){var a=GraphSeed('Table');var b=SortCol;SortCol=1;a.sort(sortMultiDimensional);SortCol=b;var c='<table border><caption>'+ReturnToMain()+'</caption>';c+='<tr><th>Rank</th><th>Seed</th><th>Count</th><th>Seed Details</th></tr>';var d=/SEED = (\w+)/i;for(var i=0;(i<a.length-1)&&(a[i]!=undefined);i++){var e=d.exec(a[i][2]);if(e==null){continue}var f='<input type="button" value="Details"onclick="alert(\''+a[i][2]+'\');">';c+='<tr><td>'+(i+1)+'</td><td>'+e[1]+'</td><td align=right>'+addCommas(a[i][1])+'</td><td align=right>'+f+'</td></tr>'}c+='</table>';var g='<h4>Navigation</h4><input type="button" value="Top"onclick="moveWindow('+"'Top'"+');">';g+='<input type="button" value="Bottom"onclick="moveWindow('+"'Bottom'"+');"><br>'+ReturnToMain();document.getElementById("FloatMenu").innerHTML=g;document.getElementById("sheetText").innerHTML=c;document.getElementById("TableText").innerHTML=''}function drawXYgraph(a,b,c,d){var e=SortCol;SortCol=0;a.sort(sortMultiDimensionalDown);for(var i=0;i<a.length;i++){a[i][3]=i}SortCol=1;a.sort(StableSort);var f='<table height=300px width=400px cellSpacing=0 cellPadding=0 border=1  Align=left><tr><td>';f+='<TABLE height=100% width=100% cellSpacing=0 cellPadding=0 border=0 Align=left>';var g=((GraphOption==7)&&(d>100))?a.length-d:0;var h=TransparentBox('1px','1px','');for(var y=b;y>=0;y--){f+='<tr>';var j=b/2;if(y==b){var k=(GraphOption==0)?'30nt':(GraphOption==4)?'5p':'100%';f+='<td rowspan='+j+' valign=top>'+k+'</td>'}else if(y==j){var l=(GraphOption==0)?'1nt':(GraphOption==4)?'3p':'0%';j++;f+='<td rowspan='+j+' valign=bottom>'+l+'</td>'}var m=0;d=(GraphOption==9)?a.length-1:miRBaseDataSet.length-1;for(var x=0;((x<=b)&&(g<d));x++){var n='red';if(y==99){var o=0}if((a[g][1]==y)&&(a[g][0]==x)){f+=(m>0)?m+'>'+h+'</TD>':'';m=0;while((g<d)&&(a[g][1]==y)&&(a[g][0]==x)){g++;if(GraphOption==7){if(g==miRBaseDataSet.length-50){c+='<p class="subaxis">(50th = '+y+' %)</p>';n='green'}else if(g==miRBaseDataSet.length-100){c+='<p class="subaxis">(100th = '+y+' %)</p>';n='green'}}}var p=TransparentBox('1px','1px','');var q=(GraphOption==9)?'alert(\''+a[g-1][2]+'\');':'displayMirnaInfo('+a[g-1][2]+');';var r='onmouseover="printID('+a[g-1][2]+');"';f+='<td style="background-color:'+n+'" onclick="'+q+'"'+r+'>'+p+'</TD>'}else if(a[g][1]==y){if(y!=0){f+=(m==0)?'<td colspan=':'';m++}else{f+='<td>'+h+'</TD>'}}else{f+='<td>'+h+'</TD>';if(y!=0){break}}}f+=(g>=miRBaseDataSet.length-1)?'<td>'+h+'</td>':'';f+='</tr>'}var s='';for(var i=0;i<Options.length;i++){if(i==1){continue}var t=(i==6)?'displayAllPolyCistrons();':(i==9)?'GraphSeed();':'XY_Scatter();';s+='<input type="button" value="'+Options[i]+'" onclick="GraphOption='+i+';'+t+'"><br>'}var u=TotalTags();s+='Total miRs = '+addCommas(u.mir);s+='<br>Other = '+addCommas(u.other);s+='<br>Total Reads = '+addCommas(u.everything);s+='<br><div id="spot"></div>';f+='</table></tr></td></table>';var v='<caption><input type="button" value="Export miR ID stats" onclick="ExportStats();"><input type="button" value="list miRBase coordinates" onclick="mirBase_Coords();">';v+='<input type="button" value="list seed abundance" onclick="CreateSeedTable();"><input type="button" value="miR cluster counts" onclick="displayAllPolyCistrons(\'Data\');">';v+='<input type="button" value="Display sample info" onclick="DisplaySampleInfo();"></caption>';f='<TABLE cellSpacing=0 cellPadding=0 border=0>'+v+'<tr><td>&nbsp</td></tr><tr><td><div class="axislabels" id="Y-Axis">'+Options[GraphOption]+'</div></td><td>'+f+'</td><td>'+s+'</td></tr><tr><td></td><td align=center>'+c+'</td></tr><tr><td>&nbsp</td></tr> </table>';SortCol=e;document.getElementById("sheetText").innerHTML=f}function printID(a){var b;if(a==undefined){document.getElementById("spot").innerHTML='';return('')}for(var i=0;i<miRBaseDataSet.length-1;i++){if(miRBaseDataSet[i][0]==a){b=i;continue}}document.getElementById("spot").innerHTML='Last dot hovered over:'+miRBaseDataSet[b][1]}function DownloadSeq(){document.getElementById("SheetText").innerHTML='Please be patient this could take some time<br>'+ReturnToMain();var a='<table border=1><th>Sequence</th><th>Freq</th>';for(var i=0;i<data.length-1;i++){a+='<tr><td>'+miRBaseDataSet[data[i][0]][2].substr(data[i][1],data[i][2])+'</td><td>'+data[i][3]+'</td></tr>'}a+='</table>';document.getElementById("TableText").innerHTML=a}function ShowALLSeq(){var a='';ShowALL_miRs=1;for(var i=0;i<miRBaseDataSet.length-1;i++){a+=displayMirnaInfo(i,'Show all tags');var b=''}ShowALL_miRs=0;document.getElementById("sheetText").innerHTML=a;document.getElementById("TableText").innerHTML=''}function mirBase_Coords(){var a=ReturnToMain();a+='<table border=1><th>Precursor ID</th><th>5p start</th><th>5p end</th><th>3p start</th><th>3p end</th><th>Seq</th><tr>';var b=[1,4,5,6,7,2];for(var i=0;i<miRBaseDataSet.length-1;i++){for(j=0;j<6;j++){a+='<td>'+miRBaseDataSet[i][b[j]];+'</td>'}a+='</tr><tr>'}a+='</tr></table>';var c='<h4>Navigation</h4><input type="button" value="Top"onclick="moveWindow('+"'Top'"+');">';c+='<input type="button" value="Bottom"onclick="moveWindow('+"'Bottom'"+');"><br>'+ReturnToMain();document.getElementById("FloatMenu").innerHTML=c;document.getElementById("sheetText").innerHTML=a;document.getElementById("TableText").innerHTML=''}function ExportStats(){var a=ReturnToMain();a+='<table border=1><th>Precursor ID</th><th>Total counts</th><th>Avg length</th><th>Non-canonical</th><th>5p counts</th><th>3p counts</th><th>5p/(5p+3p)</th><th>5p 5\' isomiRs %</th><th>5p 3\' isomiRs %</th><th>3p 5\' isomiRs %</th><th>3p 3\' isomiRs %</th>';a+='<th>5p 5\' isomiRs counts</th><th>5p 3\' isomiRs counts</th><th>3p 5\' isomiRs counts</th><th>3p 3\' isomiRs counts</th><th>Editing counts</th><th>Editing %</th>';for(var i=0;i<miRBaseDataSet.length-1;i++){a+='<tr><td>'+miRBaseDataSet[i][1]+'</td><td>'+miRBaseDataSet[i][8]+'</td><td>'+miRBaseDataSet[i][12]+'</td><td>'+(miRBaseDataSet[i][8]-miRBaseDataSet[i][9]-miRBaseDataSet[i][10])+'</td><td>';a+=(miRBaseDataSet[i][4]==undefined)?'-</td><td>':miRBaseDataSet[i][9]+'</td><td>';a+=(miRBaseDataSet[i][6]==undefined)?'-</td><td>':miRBaseDataSet[i][10]+'</td><td>';var b=[9,13,14,15,16];for(var j=0;j<=4;j++){var c=(j<=2)?9:10;var d;if(j==0){d=((miRBaseDataSet[i][4]==undefined)||(miRBaseDataSet[i][6]==undefined))?'-':Math.round(miRBaseDataSet[i][9]/(miRBaseDataSet[i][9]+miRBaseDataSet[i][10])*1000)/10}else if((miRBaseDataSet[i][b[j]]>0)&&(miRBaseDataSet[i][c]>0)){d=Math.round(miRBaseDataSet[i][b[j]]/miRBaseDataSet[i][c]*1000)/10}else{d='-'}a+=d+'</td><td>'}a+=miRBaseDataSet[i][13]+'</td><td>'+miRBaseDataSet[i][14]+'</td><td>'+miRBaseDataSet[i][15]+'</td><td>'+miRBaseDataSet[i][16]+'</td><td>'+miRBaseDataSet[i][17];a+=(miRBaseDataSet[i][8]>0)?'</td><td>'+(miRBaseDataSet[i][17]/miRBaseDataSet[i][8]*100):'-'}a+='</tr></table>';var e='<h4>Navigation</h4><input type="button" value="Top"onclick="moveWindow('+"'Top'"+');">';e+='<input type="button" value="Bottom"onclick="moveWindow('+"'Bottom'"+');"><br>'+ReturnToMain();document.getElementById("FloatMenu").innerHTML=e;document.getElementById("sheetText").innerHTML=a;document.getElementById("TableText").innerHTML=''}function displayAllPolyCistrons(a){var b='<TABLE cellSpacing=0 cellPadding=0 border=0><tr><td>'+ReturnToMain()+'</td></tr><tr><td>';var c=SortCol;SortCol=0;miRBaseDataSet.sort(sortMultiDimensionalDown);SortCol=c;for(var i=1;i<Genome.length-1;i++){if((Genome[i][0]=='')||(isNaN(Number(Genome[i][0])))){continue}var d=miRBaseDataSet[Genome[i][0]][0];var e=NeighbourAnalysis(i,a);var f=(a=='Data')?e.match(/<TD>\d/g):e.match(/onclick/g);if(f!=null){b+=e+'</td></tr><tr><td>';i=i+f.length}}b+='</td></tr></table>';var g='<h4>Navigation</h4><input type="button" value="Top"onclick="moveWindow('+"'Top'"+');">';g+='<input type="button" value="Bottom"onclick="moveWindow('+"'Bottom'"+');"><br>'+ReturnToMain();document.getElementById("FloatMenu").innerHTML=g;document.getElementById("sheetText").innerHTML=b;document.getElementById("TableText").innerHTML=''}function DisplaySampleInfo(){document.getElementById("sheetText").innerHTML=ReturnToMain()+'<br>This is a miRspring v'+HeaderInfo.VER+' document<br><br>BAM header information:<br><fieldset><legend>RG</legend>'+HeaderInfo.RG+'</fieldset>'+'<fieldset><legend>PG</legend>'+HeaderInfo.PG+'</fieldset>'+'<fieldset><legend>CO</legend>'+HeaderInfo.CO+'</fieldset>';document.getElementById("TableText").innerHTML='';var a='<h4>Navigation</h4><input type="button" value="Top"onclick="moveWindow('+"'Top'"+');">';a+='<input type="button" value="Bottom"onclick="moveWindow('+"'Bottom'"+');"><br>'+ReturnToMain();document.getElementById("FloatMenu").innerHTML=a}function Recalculate(){var a=0;SortCol=0;miRBaseDataSet.sort(sortMultiDimensionalDown);for(var i=0;i<miRBaseDataSet.length-1;i++){miRBaseDataSet[i][8]=0;miRBaseDataSet[i][9]=0;miRBaseDataSet[i][10]=0;miRBaseDataSet[i][11]=0;miRBaseDataSet[i][13]=0;miRBaseDataSet[i][15]=0;miRBaseDataSet[i][16]=0}for(var j=0;j<data.length-1;j++){if((data[j][4]!='')&&(RNAEditing==1)){continue}else if((data[j][4]=='')&&(RNAEditing==2)){continue}else if(RNAEditing==3){var b=data[j][4].match(/AG/);var c=data[j][4].match(/CT/);if((AtoI==null)&&(c==null)){continue}}miRBaseDataSet[data[j][0]][16]+=(data[j][4]!='')?data[j][3]:0;var d=Math.abs(data[j][1]-miRBaseDataSet[data[j][0]][4]);var e=Math.abs(data[j][1]-miRBaseDataSet[data[j][0]][6]);miRBaseDataSet[data[j][0]][8]+=data[j][3];if(d<=miRBaseWindow){miRBaseDataSet[data[j][0]][9]+=data[j][3];miRBaseDataSet[data[j][0]][13]+=(d==0)?0:data[j][3]}else if(e<=miRBaseWindow){miRBaseDataSet[data[j][0]][10]+=data[j][3];miRBaseDataSet[data[j][0]][15]+=(e==0)?0:data[j][3]}else{miRBaseDataSet[data[j][0]][11]+=data[j][3]}}document.getElementById("DescriptionText").innerHTML='recalculated'}function OptionsMenu(){var a=ReturnToMain()+'<br><br>';a+='<fieldset><legend>Number of mismatches to display</legend><form><select id="EMode">';var b=['All','0 mismatches','ONLY mismatches','A to I and C to T'];for(var i=0;i<b.length;i++){var c=(i==RNAEditing)?' selected="selected"':'';a+='<option'+c+' onclick="RNAEditing='+i+';debugme();">'+b[i]+'</option>'}a+='</select> <button type="button" onclick="debugme('+"'MM'"+')">Change</button></form></fieldset>';a+="<fieldset><legend>5' window relative to mirbase to consider a tag a processed miRNA";a+='</legend><form>&plusmn;<select id="miRWindow">';for(var i=0;i<=9;i++){var c=(i==miRBaseWindow)?' selected="selected"':'';a+='<option'+c+' onclick=" debugme();">'+i+'nt</option>'}a+='</select> <button type="button" onclick="debugme('+"'miR'"+')">Change</button></form></fieldset>';a+=EditStatus();a+='<BR>'+Normalise_option_OLD()+Seed_option()+Flanking_option();a+='<fieldset><legend>Genomic window to define a miR cluster</legend><form><select id="Cluster">';for(var i=0;i<WindowSize.length;i++){var c=(i==WindowOption)?' selected="selected"':'';a+='<option'+c+' onclick="WindowOption='+i+';debugme();">'+WindowSize[i]+'</option>'}a+='</select> <button type="button" onclick="debugme('+"'MM'"+')">Change</button></form></fieldset>';document.getElementById("sheetText").innerHTML=a;document.getElementById("TableText").innerHTML='';var d='<h4>Navigation</h4><input type="button" value="Top"onclick="moveWindow('+"'Top'"+');">';d+='<input type="button" value="Bottom"onclick="moveWindow('+"'Bottom'"+');"><br>'+ReturnToMain();document.getElementById("FloatMenu").innerHTML=d;debugme()}function debugme(a){SeedClass=(document.SeedClass_window.MIRSEEDS.checked)?0:1;RPM=(document.RPM.RAWCOUNTS.checked)?0:1;var b='<br>RPM is '+RPM;b+='<br>SeedClass is '+SeedClass;b+='<br>Spacer is '+Spacer;b+='<br>FlankingSeq is '+FlankingSeq;if(document.Flanking_window.FLANKOFF.checked){Spacer=0;FlankingSeq=1}else{Spacer=SpacerMax;FlankingSeq=0}if(a=='miR'){var x=document.getElementById("miRWindow").selectedIndex;var y=document.getElementById("miRWindow").options;miRBaseWindow=y[x].index;Recalculate()}else if(a=='MM'){var x=document.getElementById("EMode").selectedIndex;var y=document.getElementById("EMode").options;EDITMODE=y[x].index;Recalculate()}var b='<br>Main table units (i.e. not individual miR view) = ';b+=(RPM==1)?'Reads per million (RPM)':'Raw counts';b+='<br>RNA classes used for seed analysis: ';b+=(SeedClass==0)?'Only miRs contribute':'All classes contribute';b+=(FlankingSeq==0)?'<br>Display '+Spacer+'nt'+'flanking sequence (displayed in lower case)':'<br>Only precursor is shown';b+='<br>miR window = '+miRBaseWindow+' nt<br>Mismatches in sequence reads: ';b+=(EDITMODE==0)?'SHOW ALL':(EDITMODE==1)?'0 mismatches':(EDITMODE==2)?'ONLY mismatches':'only A to I and C to T'}miRBaseDataSet.sort(sortMultiDimensional);Largest_Count=miRBaseDataSet[0][8]+100;Smallest_Count=miRBaseDataSet[(miRBaseDataSet.length-2)][8];displayTable();XY_Scatter();</script></body></html>
